<div class="mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8 py-4 sm:py-6">
  <header class="mb-8">
    <h1 class="text-3xl font-bold text-slate-800 dark:text-slate-100">Admin Dashboard</h1>
    <p class="text-slate-600 dark:text-slate-300 mt-1">An overview of your forum's activity and statistics.</p>
  </header>

  <!-- Snapshot Stats -->
  <section class="mb-8">
    <h2 class="text-xl font-semibold text-slate-700 dark:text-slate-200 mb-4">Snapshot</h2>
    <div *ngIf="isLoading" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-7 gap-4">
      <!-- Update skeleton to show 7 items -->
      <p-skeleton height="6rem" styleClass="rounded-lg" *ngFor="let i of [1,2,3,4,5,6,7]"></p-skeleton>
    </div>
    <div *ngIf="!isLoading && dashboardData?.snapshotStats as stats" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-7 gap-4">
      <!-- Members -->
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow flex items-center gap-4">
        <ng-icon name="heroUsers" class="h-8 w-8 text-sky-500"></ng-icon>
        <div>
          <p class="text-sm text-slate-500 dark:text-slate-400">Members</p>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-100">{{ stats.memberCount }}</p>
        </div>
      </div>
      <!-- Forums -->
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow flex items-center gap-4">
        <ng-icon name="heroChatBubbleBottomCenterText" class="h-8 w-8 text-indigo-500"></ng-icon>
        <div>
          <p class="text-sm text-slate-500 dark:text-slate-400">Forums</p>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-100">{{ stats.forumCount }}</p>
        </div>
      </div>
      <!-- Discussions -->
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow flex items-center gap-4">
        <ng-icon name="heroChatBubbleLeftRight" class="h-8 w-8 text-emerald-500"></ng-icon>
        <div>
          <p class="text-sm text-slate-500 dark:text-slate-400">Discussions</p>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-100">{{ stats.discussionCount }}</p>
        </div>
      </div>
      <!-- Tags -->
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow flex items-center gap-4">
        <ng-icon name="heroTag" class="h-8 w-8 text-amber-500"></ng-icon>
        <div>
          <p class="text-sm text-slate-500 dark:text-slate-400">Tags</p>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-100">{{ stats.tagCount }}</p>
        </div>
      </div>
      <!-- Comments -->
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow flex items-center gap-4">
        <ng-icon name="heroChatBubbleLeft" class="h-8 w-8 text-rose-500"></ng-icon>
        <div>
          <p class="text-sm text-slate-500 dark:text-slate-400">Comments</p>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-100">{{ stats.commentCount }}</p>
        </div>
      </div>
      <!-- START: New Cards -->
      <!-- Attachments -->
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow flex items-center gap-4">
        <ng-icon name="heroPaperClip" class="h-8 w-8 text-slate-500"></ng-icon>
        <div>
          <p class="text-sm text-slate-500 dark:text-slate-400">Attachments</p>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-100">{{ stats.attachmentCount }}</p>
        </div>
      </div>
      <!-- Images -->
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow flex items-center gap-4">
        <ng-icon name="heroPhoto" class="h-8 w-8 text-violet-500"></ng-icon>
        <div>
          <p class="text-sm text-slate-500 dark:text-slate-400">Images</p>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-100">{{ stats.imageCount }}</p>
        </div>
      </div>
      <!-- END: New Cards -->
    </div>
  </section>

  <!-- Ranked Lists (no changes needed below this line) -->
  <section>
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-semibold text-slate-700 dark:text-slate-200">Rankings</h2>
      <p-selectButton [options]="timeWindowOptions" [(ngModel)]="selectedTimeWindow" (onChange)="onTimeWindowChange()" optionLabel="label" optionValue="value"></p-selectButton>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
      <!-- User Rankings -->
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow space-y-4">
        <h3 class="font-semibold text-slate-800 dark:text-slate-100 border-b dark:border-slate-700 pb-2">Top Members</h3>
        <!-- By Discussions -->
        <div *ngIf="!isLoading">
          <h4 class="text-sm font-medium text-slate-600 dark:text-slate-300 mb-2">Most Discussions</h4>
          <ul *ngIf="dashboardData?.usersByDiscussions?.length; else noData" class="space-y-2">
            <li *ngFor="let item of dashboardData?.usersByDiscussions" class="flex justify-between items-center text-sm">
              <a [routerLink]="getRouterLink(item, 'user')" class="text-indigo-600 hover:underline dark:text-indigo-400 truncate" [title]="item.name">{{ item.name }}</a>
              <span class="font-mono bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded text-xs">{{ item.value }}</span>
            </li>
          </ul>
        </div>
        <div *ngIf="isLoading"><p-skeleton height="8rem"></p-skeleton></div>
        <!-- By Comments -->
        <div *ngIf="!isLoading">
          <h4 class="text-sm font-medium text-slate-600 dark:text-slate-300 mb-2">Most Comments</h4>
          <ul *ngIf="dashboardData?.usersByComments?.length; else noData" class="space-y-2">
            <li *ngFor="let item of dashboardData?.usersByComments" class="flex justify-between items-center text-sm">
              <a [routerLink]="getRouterLink(item, 'user')" class="text-indigo-600 hover:underline dark:text-indigo-400 truncate" [title]="item.name">{{ item.name }}</a>
              <span class="font-mono bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded text-xs">{{ item.value }}</span>
            </li>
          </ul>
        </div>
        <div *ngIf="isLoading"><p-skeleton height="8rem"></p-skeleton></div>
        <!-- By Reputation -->
        <div *ngIf="!isLoading">
          <h4 class="text-sm font-medium text-slate-600 dark:text-slate-300 mb-2">Most Reputable</h4>
          <ul *ngIf="dashboardData?.usersByReputation?.length; else noData" class="space-y-2">
            <li *ngFor="let item of dashboardData?.usersByReputation" class="flex justify-between items-center text-sm">
              <a [routerLink]="getRouterLink(item, 'user')" class="text-indigo-600 hover:underline dark:text-indigo-400 truncate" [title]="item.name">{{ item.name }}</a>
              <span class="font-mono bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded text-xs">{{ item.value }}</span>
            </li>
          </ul>
        </div>
        <div *ngIf="isLoading"><p-skeleton height="8rem"></p-skeleton></div>
      </div>

      <!-- Discussion Rankings -->
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow space-y-4">
        <h3 class="font-semibold text-slate-800 dark:text-slate-100 border-b dark:border-slate-700 pb-2">Top Discussions</h3>
        <!-- By Views -->
        <div *ngIf="!isLoading">
          <h4 class="text-sm font-medium text-slate-600 dark:text-slate-300 mb-2">Most Viewed</h4>
          <ul *ngIf="dashboardData?.discussionsByViews?.length; else noData" class="space-y-2">
            <li *ngFor="let item of dashboardData?.discussionsByViews" class="flex justify-between items-center text-sm">
              <a [routerLink]="getRouterLink(item, 'discussion')" class="text-indigo-600 hover:underline dark:text-indigo-400 truncate" [title]="item.name">{{ item.name }}</a>
              <span class="font-mono bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded text-xs">{{ item.value }}</span>
            </li>
          </ul>
        </div>
        <div *ngIf="isLoading"><p-skeleton height="8rem"></p-skeleton></div>
        <!-- By Comments -->
        <div *ngIf="!isLoading">
          <h4 class="text-sm font-medium text-slate-600 dark:text-slate-300 mb-2">Most Commented</h4>
          <ul *ngIf="dashboardData?.discussionsByComments?.length; else noData" class="space-y-2">
            <li *ngFor="let item of dashboardData?.discussionsByComments" class="flex justify-between items-center text-sm">
              <a [routerLink]="getRouterLink(item, 'discussion')" class="text-indigo-600 hover:underline dark:text-indigo-400 truncate" [title]="item.name">{{ item.name }}</a>
              <span class="font-mono bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded text-xs">{{ item.value }}</span>
            </li>
          </ul>
        </div>
        <div *ngIf="isLoading"><p-skeleton height="8rem"></p-skeleton></div>
      </div>

      <!-- Tag & Forum Rankings -->
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow space-y-4">
        <h3 class="font-semibold text-slate-800 dark:text-slate-100 border-b dark:border-slate-700 pb-2">Top Categories</h3>
        <!-- Tags By Views -->
        <div *ngIf="!isLoading">
          <h4 class="text-sm font-medium text-slate-600 dark:text-slate-300 mb-2">Most Viewed Tags</h4>
          <ul *ngIf="dashboardData?.tagsByViews?.length; else noData" class="space-y-2">
            <li *ngFor="let item of dashboardData?.tagsByViews" class="flex justify-between items-center text-sm">
              <a [routerLink]="getRouterLink(item, 'tag')" [queryParams]="{ tagIds: item.id }" class="text-indigo-600 hover:underline dark:text-indigo-400 truncate" [title]="item.name">{{ item.name }}</a>
              <span class="font-mono bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded text-xs">{{ item.value }}</span>
            </li>
          </ul>
        </div>
        <div *ngIf="isLoading"><p-skeleton height="8rem"></p-skeleton></div>
        <!-- Forums By Comments -->
        <div *ngIf="!isLoading">
          <h4 class="text-sm font-medium text-slate-600 dark:text-slate-300 mb-2">Most Active Forums</h4>
          <ul *ngIf="dashboardData?.forumsByComments?.length; else noData" class="space-y-2">
            <li *ngFor="let item of dashboardData?.forumsByComments" class="flex justify-between items-center text-sm">
              <a [routerLink]="getRouterLink(item, 'forum')" class="text-indigo-600 hover:underline dark:text-indigo-400 truncate" [title]="item.name">{{ item.name }}</a>
              <span class="font-mono bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded text-xs">{{ item.value }}</span>
            </li>
          </ul>
        </div>
        <div *ngIf="isLoading"><p-skeleton height="8rem"></p-skeleton></div>
      </div>
    </div>
  </section>

  <ng-template #noData>
    <p class="text-xs text-slate-400 dark:text-slate-500 italic">No data available for this period.</p>
  </ng-template>

</div>
