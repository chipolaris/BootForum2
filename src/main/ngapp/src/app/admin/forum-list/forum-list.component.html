<div class="mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8 py-4 sm:py-6">
  <p-toast></p-toast>

  <div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-semibold text-indigo-700">Manage Forums</h2>
    <button pButton type="button" label="Create New Forum" icon="pi pi-plus"
            class="p-button-success p-button-sm" routerLink="/app/admin/forum-create"></button>
  </div>

  <div *ngIf="isLoading" class="flex justify-center items-center my-8">
    <p-progressSpinner styleClass="w-12 h-12" strokeWidth="4"></p-progressSpinner>
    <span class="ml-3 text-lg text-gray-600">Loading forums...</span>
  </div>

  <div *ngIf="errorMessage && !isLoading" class="mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-md shadow">
    <p class="font-medium">Error:</p>
    <p>{{ errorMessage }}</p>
  </div>

  <div *ngIf="!isLoading && !errorMessage" class="shadow-lg rounded-lg overflow-hidden">
    <p-table #dt [value]="forums" [paginator]="true" [rows]="10" [rowsPerPageOptions]="[5,10,20]"
             responsiveLayout="scroll" styleClass="p-datatable-striped p-datatable-sm primeng-table-smaller-font"
             [globalFilterFields]="['title', 'description']">
      <ng-template pTemplate="caption">
        <div class="flex flex-col sm:flex-row justify-between items-center p-py-2">
          <span class="p-input-icon-left mb-2 sm:mb-0">
            <i class="pi pi-search"></i>
            <input pInputText type="text"
                   (input)="$event.target && dt && dt.filterGlobal($any($event.target).value, 'contains')"
                   placeholder="Search forums..." class="p-inputtext-sm" />
          </span>
        </div>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="id" class="w-1/12">ID <p-sortIcon field="id"></p-sortIcon></th>
          <th pSortableColumn="title" class="w-3/12">Title <p-sortIcon field="title"></p-sortIcon></th>
          <th pSortableColumn="description" class="w-4/12">Description <p-sortIcon field="description"></p-sortIcon></th>
          <th class="w-1/12 text-center">Icon</th>
          <th class="w-1/12 text-center">Active <p-sortIcon field="active"></p-sortIcon></th>
          <th class="w-2/12 text-center">Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-forum>
        <tr>
          <td class="align-middle">{{ forum.id }}</td>
          <td class="align-middle">{{ forum.title }}</td>
          <td class="truncate max-w-xs align-middle" [pTooltip]="forum.description" tooltipPosition="top">{{ forum.description }}</td>
          <td class="text-center align-middle">
            <div class="flex items-center justify-center">
              <span *ngIf="forum.icon" class="mr-1" [pTooltip]="forum.icon" tooltipPosition="top">{{ forum.icon }}</span>
              <div *ngIf="forum.iconColor" class="w-4 h-4 rounded-full border border-gray-400"
                   [style.backgroundColor]="forum.iconColor" [pTooltip]="forum.iconColor" tooltipPosition="top">
              </div>
            </div>
          </td>
          <td class="text-center align-middle">
            <p-tag [value]="forum.active ? 'Yes' : 'No'" [severity]="getSeverity(forum.active)"></p-tag>
          </td>
          <td class="text-center space-x-2 align-middle">
            <button pButton pRipple type="button" icon="pi pi-pencil"
                    class="p-button-rounded p-button-info p-button-sm"
                    (click)="editForum(forum.id)" pTooltip="Edit Forum" tooltipPosition="top"></button>
            <button pButton pRipple type="button" icon="pi pi-trash"
                    class="p-button-rounded p-button-danger p-button-sm"
                    (click)="deleteForum(forum.id)" pTooltip="Delete Forum" tooltipPosition="top"></button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="text-center p-4">No forums found.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
